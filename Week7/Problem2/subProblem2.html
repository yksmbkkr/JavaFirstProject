<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
      integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="../../week6/custom.css" />
    <script
      src="https://kit.fontawesome.com/bd2da8549a.js"
      crossorigin="anonymous"
    ></script>

    <title>Assignment 7 | PS</title>
  </head>
  <body>
    <header>
      <div class="collapse bg-dark" id="navbarHeader">
        <div class="container">
          <div class="row">
            <div class="col-sm-8 col-md-7 py-4">
              <h4 class="text-white">By</h4>
              <p class="text-white">Yash Kulshreshtha</p>
            </div>
            <div class="col-sm-4 offset-md-1 py-4">
              <h4 class="text-white">Contact</h4>
              <ul class="list-unstyled">
                <li>
                  <a href="https://linkedin.com/in/yksmbllr" class="text-white"
                    >LinkedIn</a
                  >
                </li>
                <li>
                  <a href="mailto:yash@yash99.tech" class="text-white">Email</a>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <nav class="navbar navbar-dark bg-dark shadow-sm">
        <div class="container d-flex justify-content-between">
          <a href="#" class="navbar-brand d-flex align-items-center">
            <i class="fas fa-chalkboard-teacher fa-2x"></i>&nbsp;
            <strong>Practice Page</strong>
          </a>
          <button
            class="navbar-toggler collapsed"
            type="button"
            data-toggle="collapse"
            data-target="#navbarHeader"
            aria-controls="navbarHeader"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <!-- <span class="navbar-toggler-icon"></span> -->
            <!-- <span class="sr-only">Toggle navigation</span> -->
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>
        </div>
      </nav>
    </header>

    <main role="main">
      <section
        class="text-center"
        id="head-container"
        style="min-height: 50vh !important;"
      >
        <div class="container">
          <div class="row">
            <div class="col-12" style="margin-top: 5em;">
              <h1 class="text-white">Assignement 7</h1>
              <p class="lead text-white">JS Table Practice</p>
            </div>
          </div>
        </div>
      </section>

      <section class="bg-dark">
        <div class="container">
          <div class="row">
            <div class="col-md-10 ml-auto mr-auto text-white pt-4">
              <div
                class="card border-primary my-3"
                style="background: transparent;"
              >
                <div class="card-header bg-primary text-white">
                  EMPLOYEE DATA INPUT
                </div>
                <div class="card-body text-white">
                  <form id="e-data-form">
                    <div class="form-row">
                      <div class="col-9">
                        <label for="idname">Name</label>
                        <input
                          type="text"
                          class="form-control"
                          id="idname"
                          name="name"
                          required
                        />
                      </div>
                      <div class="col-3">
                        <label for="idgender">Gender</label>
                        <select
                          class="form-control"
                          id="idgender"
                          name="gender"
                          required
                        >
                          <option value="male">Male</option>
                          <option value="female">Female</option>
                        </select>
                      </div>
                    </div>
                    <div class="form-row mt-3">
                      <div class="col-9">
                        <label for="idcity">City</label>
                        <input
                          type="text"
                          class="form-control"
                          id="idcity"
                          name="city"
                          required
                        />
                      </div>
                      <div class="col-3">
                        <label for="idage">Age</label>
                        <input
                          type="text"
                          class="form-control"
                          id="idage"
                          name="age"
                          onkeypress="return isNumber(event)"
                          required
                        />
                      </div>
                    </div>
                    <button
                      type="submit"
                      class="btn btn-primary btn-round btn-block mt-3"
                    >
                      Save
                    </button>
                  </form>
                </div>
              </div>
            </div>
            <div
              class="col-md-10 ml-auto mr-auto my-4"
              style="display: none;"
              id="table-div"
            >
              <div
                class="card border-primary text-white"
                style="background: transparent;"
              >
                <div class="card-header bg-primary">STORED EMPLOYEE DATA</div>
                <div class="card-body">
                  <div class="col-12">
                    <table class="table table-hover text-white">
                      <thead>
                        <tr>
                          <th scope="col">ID</th>
                          <th scope="col">Name</th>
                          <th scope="col">Gender</th>
                          <th scope="col">City</th>
                          <th scope="col">Age</th>
                        </tr>
                      </thead>
                      <tbody id="tbody-data"></tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div style="width: 100%; min-height: 30vh;"></div>
        </div>
      </section>
    </main>

    <footer class="text-muted">
      <div class="container">
        <p class="float-right">
          <a href="#">Back to top</a>
        </p>
        <p>Built with Bootstrap 4.5</p>
      </div>
    </footer>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script
      src="https://code.jquery.com/jquery-3.5.1.min.js"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
      integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
      integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
      crossorigin="anonymous"
    ></script>
    <script src="../../week6/three.r95.min.js"></script>
    <script src="../../week6/vanta.net.min.js"></script>

    <script>
      VANTA.NET({
        el: "#head-container",
        mouseControls: true,
        touchControls: true,
        minHeight: 200.0,
        minWidth: 200.0,
        scale: 1.0,
        scaleMobile: 1.0,
      });
    </script>
    <script>
      function isNumber(evt) {
        evt = evt ? evt : window.event;
        var charCode = evt.which ? evt.which : evt.keyCode;
        if (charCode > 31 && (charCode < 48 || charCode > 57)) {
          return false;
        }
        return true;
      }
    </script>
    <script>
      $(document).ready(function () {
        tableRender();

        $("#e-data-form").submit(function () {
          // DO STUFF...
          console.log("submit");

          if (typeof Storage === "undefined") {
            alert(
              "Can not store data beacuse local storage is not supported by your browser !"
            );
          } else {
            if (localStorage.getItem("employeeDataJSON") === null) {
              storageInit();
            }
            let eform = document.getElementById("e-data-form");
            let edata = new FormData(eform);
            let ejson = Object.fromEntries(edata.entries());
            console.log(ejson);
            storeData(ejson);
          }

          return false; // return false to cancel form action
        });
      });
    </script>
    <script>
      function tableRender() {
        if (localStorage.getItem("employeeDataJSON") !== null) {
          // let count = parseInt(localStorage.getItem("employeeCount"));
          let data = JSON.parse(localStorage.getItem("employeeDataJSON"));
          var rows = "";
          for (let index = 0; index < data.length; index++) {
            const element = data[index];
            rows +=
              "<tr><td>" +
              element["id"] +
              "</td><td>" +
              element["name"] +
              "</td><td>" +
              element["gender"] +
              "</td><td>" +
              element["city"] +
              "</td><td>" +
              element["age"] +
              "</td></tr>";
          }
          $(rows).appendTo("#tbody-data");

          $("#table-div").show();
        }
      }

      function tableAppend(edata) {
        var rows = "";
        rows +=
          "<tr><td>" +
          edata["id"] +
          "</td><td>" +
          edata["name"] +
          "</td><td>" +
          edata["gender"] +
          "</td><td>" +
          edata["city"] +
          "</td><td>" +
          edata["age"] +
          "</td></tr>";
        $(rows).appendTo("#tbody-data");
        if (!$("#table-div").is(":visible")) {
          $("#table-div").show();
        }
      }

      function storageInit() {
        localStorage.setItem("employeeCount", 1000);
        localStorage.setItem("employeeDataJSON", "[]");
      }

      function storeData(eObj) {
        let count = parseInt(localStorage.getItem("employeeCount")) + 1;
        eObj["id"] = count;
        let prev = JSON.parse(localStorage.getItem("employeeDataJSON"));
        prev.push(eObj);
        localStorage.setItem("employeeCount", count);
        localStorage.setItem("employeeDataJSON", JSON.stringify(prev));
        tableAppend(eObj);
      }
    </script>
  </body>
</html>
